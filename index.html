<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Layoutside</title>
    <link rel="stylesheet" href="css/blueprint/screen.css" type="text/css" media="screen, projection">
    <link rel="stylesheet" href="css/blueprint/print.css" type="text/css" media="print">
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="css/blueprint/ie.css" type="text/css" media="screen, projection">
    <![endif]-->
    
    <link rel="stylesheet" href="css/style.css" type="text/css" media="handheld, all">
    <link rel="stylesheet" href="js/jquery/css/smoothness/jquery-ui-1.8.5.custom.css" type="text/css">
</head>
<body class="">
    <div id="widemenu">    
        <div id="menuarea">
            <a href="#" title="Layoutside"><img id="logo" src="images/logo.jpg" alt="Layoutside" /></a>
            <ul id="menu">
                <li><a href="#" title="Layout">layout</a>
                    <ul><li><a href="#">save</a></li>
                        <li><a href="#">save as lorem ispum</a></li></ul>
                </li>
                <li><a id="openEditor" href="#" title="Editor">editor</a></li>
                <li><a href="#" title="Layout">download</a></li>
                <li><a href="#" title="Layout">get the code</a>
                    <ul><li><a href="#">html</a></li>
                        <li><a href="#">lorem ispum dolor sit amet</a></li>
                        <li><a href="#">css</a></li>
                        <li><a href="#">tar package</a></li></ul>
                </li>
                <li><a href="#" title="Layout">feedback</a></li>
                <li><a href="#" title="Layout">help</a>
                    <ul><li><a href="#">forum</a></li>
                        <li><a href="#">go to somewhere else</a></li>
                        <li><a href="#">about</a></li></ul>
                </li>
            </ul>
            <div id="user">
                <a href="#" title="User">michaelpaul</a> <br />
                <a href="#" title="logout">logout</a>
            </div>
        </div>
    </div>

    <div id="containerPlaceholder" class="container">
        <div id="containerGrid"></div> 
        <div id="container"></div> 
    </div>
            
    <div id="widetool">
        <div id="toolbar">
            <ul>
                <li><a class="icon icon-select" href="#select" title="Select">Select</a></li>
                <li><a class="icon icon-sort" href="#sort" title="Reorder">Reorder</a></li>
                <li class="icon-separator">|</li>
                <li><a class="icon icon-section" href="#add-section" title="Add section">Add section</a></li>
                <li class="icon-separator">|</li>
                <li><a class="icon icon-toggle-grid" href="#" title="toggle grid">toggle grid</a></li>
            </ul>
            <div id="measures">
                <input id="section-w" type="text" value="0" disabled="disabled"> x <input id="section-h" type="text" value="0"> px
            </div>
        </div>
    </div>

    <div id="dialogs">
        <div class="sectionDialog" title="Section Dialog">
            <form name="sectionProperties">	        
                <p>
                    <label>Id</label>
                    <input name="sec-id" type="text">
                    <label>Class</label>
                    <input name="class-name" type="text">
                </p>
	            <p>
                    <label>Tagname</label>
                    <select name="tagname">
                        <option>div</option>
                        <option>section</option>
                        <option>nav</option>
                        <option>header</option>
                        <option>footer</option>
                    </select>
                </p>
                <p class="slider-space-row">
                    <label>Left space</label>
                    <div class="space-slider"></div>
                </p>
                <div class="clear"></div>
                <p class="slider-space-row">
                    <label>Rigth space</label>
                    <div class="space-slider"></div>
                </p>
                <div class="clear"></div>
                <p>
                    <label>Aditional classes</label><br>
                        <input type="checkbox">Last
                        <input type="checkbox"> Clear 
                        <input type="checkbox"> box 
                        <input type="checkbox"> border
                        <br>
                        <input type="checkbox"> colborder 
                        <input type="checkbox"> append-bottom
                        <input type="checkbox"> prepend-top
                </p>
            </form>
        </div>

        <div id="editor" title="Source editor">
            <label for="section-list">Current section: </label>
            <select id="section-list" name="test"></select>
            <div id="editorAres" style="border: 1px solid #AAA;">
                <textarea id="sourceEditor" style="width: 100%; height: 350px;">
&lt;h2>Lorem ipsum dolor&lt;/h2>  
&lt;p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo 
ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis 
parturient montes, nascetur ridiculus mus.&lt;/p>
&lt;p>Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. 
Nulla consequat massa quis enim. Vivamus elementum semper nisi. 
Aenean vulputate eleifend&lt;/p>
                 </textarea>
            </div>
        </div>
    </div>

    <script src="js/jquery/js/jquery-1.4.2.min.js"></script>
    <script src="js/jquery/js/jquery-ui-1.8.5.custom.min.js"></script>
    <script src="js/codemirror/js/codemirror.js"></script>
    <script type="text/javascript" src="js/layoutside.js"></script>    
    <script type="text/javascript">
    jQuery(function () {
        window.Layoutside = new Layoutside();
        Layoutside.Layout.open(155);

        var target = null;
        var pts = 'js/codemirror/css/';
        
        $('#editor').dialog({
            resizable: false, autoOpen: false, width: '75%', height: 475,
            buttons: {
                'Update': function () {
                    if(target == null)
                        return false;
// console.log(target.find('.section-content'));
                    target.find('.section-content').html(editor.getCode());        
                },
                'Close': function () {
                    $('#editor').dialog('close');
                }
            }, 
            open: function () {
       //         console.log('code editor open');
                var sections = Layoutside.Container.ui.find('> .section');
                var o;
                $('#section-list').html('');
                sections.each(function (i, s) {
                    o = document.createElement('option');
                    o.innerHTML = 'Section ' + (i + 1);
                    $(o).data('domNode', s);
                    $('#section-list').append(o);                
                });
                target = $($('#section-list option:first').data('domNode'));
                editor.setCode(target.find('.section-content').html());            
            }
	    }); 


        $('#openEditor').click(function (e) {
            $('#editor').dialog('open');
            e.preventDefault();
        });


        var editor = CodeMirror.fromTextArea('sourceEditor', {
            parserfile: ["parsexml.js", 
                "parsecss.js", 
                "tokenizejavascript.js", 
                "parsejavascript.js", 
                "parsehtmlmixed.js"],
            stylesheet: [pts + "xmlcolors.css", 
                pts + "jscolors.css", 
                pts + "csscolors.css"],
            path: 'js/codemirror/js/'
        });

        $('#section-list').change(function () {
            target = $($(this).find('option')
                .eq($(this).attr('selectedIndex')).data('domNode'));
            editor.setCode(target.find('.section-content').html());            
                /*var sect = $($(this).find('option')
                .eq($(this).attr('selectedIndex')).data('domNode'));
            sect.html(editor.getCode()); */
        });
    });
    </script>
</body>
</html>

